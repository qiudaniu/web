<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>首页</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="../../bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <!-- Google fonts - Popppins for copy-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,800">
    <!-- orion icons-->
    <link rel="stylesheet" href="../../css/orionicons.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="../../css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="../../public/css/custom.css">
    <!-- Favicon-->
    <link rel="shortcut icon" href="../../img/favicon.png?3">
    <!-- Tweaks for older IEs-->
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <script type="text/javascript">
        if (! localStorage.getItem('admin-token')) {
            window.location.href = '../login.html';
        }
    </script>
</head>
<body>
<header class="header">
    <nav class="navbar navbar-expand-lg px-4 py-2 bg-white shadow"><a href="#" class="sidebar-toggler text-gray-500 mr-4 mr-lg-5 lead"><i class="fas fa-align-left"></i></a><a href="#" class="navbar-brand font-weight-bold text-uppercase text-base">后台管理系统</a>
        <ul class="ml-auto d-flex align-items-center list-unstyled mb-0">
            <li class="nav-item dropdown ml-auto"><a id="userInfo" href="http://example.com" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="nav-link dropdown-toggle"><img src="../../img/avatar-6.jpg" alt="Jason Doe" style="max-width: 2.5rem;" class="img-fluid rounded-circle shadow"></a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="#"
                       onclick="exit()">
                        退出
                    </a>
                </div>
            </li>
        </ul>
    </nav>
</header>
<div class="d-flex align-items-stretch">
    <div id="sidebar" class="sidebar py-3">
        <div class="text-gray-400 text-uppercase px-3 px-lg-4 py-4 font-weight-bold small headings-font-family">主页</div>
        <ul class="sidebar-menu list-unstyled">
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#user" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>用户</span></a>
                <div id="user" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../user/index.html" class="sidebar-link text-muted pl-lg-5">用户列表</a></li>
                        <li class="sidebar-list-item"><a href="../user/create.html" class="sidebar-link text-muted pl-lg-5">新增用户</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#admin" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>管理员</span></a>
                <div id="admin" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../admin/index.html" class="sidebar-link text-muted pl-lg-5">管理员列表</a></li>
                        <li class="sidebar-list-item"><a href="../admin/create.html" class="sidebar-link text-muted pl-lg-5">新增管理员</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#goods" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>商品</span></a>
                <div id="goods" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../goods/index.html" class="sidebar-link text-muted pl-lg-5">商品列表</a></li>
                        <li class="sidebar-list-item"><a href="../goods/create.html" class="sidebar-link text-muted pl-lg-5">新增商品</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#goodsType" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>商品类型</span></a>
                <div id="goodsType" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../goodsType/index.html" class="sidebar-link text-muted pl-lg-5">商品类型列表</a></li>
                        <li class="sidebar-list-item"><a href="../goodsType/create.html" class="sidebar-link text-muted pl-lg-5">新增商品类型</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#orders" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>订单</span></a>
                <div id="orders" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../orders/index.html" class="sidebar-link text-muted pl-lg-5">订单列表</a></li>
                        <li class="sidebar-list-item"><a href="../orders/create.html" class="sidebar-link text-muted pl-lg-5">新增订单</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#express" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>快递商</span></a>
                <div id="express" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../express/index.html" class="sidebar-link text-muted pl-lg-5">快递商列表</a></li>
                        <li class="sidebar-list-item"><a href="../express/create.html" class="sidebar-link text-muted pl-lg-5">新增快递商</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#role" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>角色</span></a>
                <div id="role" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../roles/index.html" class="sidebar-link text-muted pl-lg-5">角色列表</a></li>
                        <li class="sidebar-list-item"><a href="../roles/create.html" class="sidebar-link text-muted pl-lg-5">新增角色</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#operation" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>操作</span></a>
                <div id="operation" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../operations/index.html" class="sidebar-link text-muted pl-lg-5">操作列表</a></li>
                        <li class="sidebar-list-item"><a href="../operations/create.html" class="sidebar-link text-muted pl-lg-5">新增操作</a></li>
                    </ul>
                </div>
            </li>
            <li class="sidebar-list-item"><a href="#" data-toggle="collapse" data-target="#data" aria-expanded="false" aria-controls="pages" class="sidebar-link text-muted"><i class="o-wireframe-1 mr-3 text-gray"></i><span>数据统计</span></a>
                <div id="data" class="collapse">
                    <ul class="sidebar-menu list-unstyled border-left border-primary border-thick">
                        <li class="sidebar-list-item"><a href="../statistics/index.html" class="sidebar-link text-muted pl-lg-5">系统数据统计</a></li>
                    </ul>
                </div>
            </li>
            
        </ul>
    </div>
    <div class="page-holder w-100 d-flex flex-wrap">
        <div class="container-fluid px-xl-5">
            <div class="col-lg-12 mb-5">
                <div class="card">
                    <div class="card-header">
                        <h3 class="h6 text-uppercase mb-0">修改信息</h3>
                    </div>
                    <div class="card-body">
                        <form class="form-horizontal" method="post">
                            <div class="form-group row">
                                <label for="name" class="col-md-2 form-control-label"><span style="font-size: 20px">商品名</span></label>
                                <div class="col-md-9">
                                    <input id="name" type="text" name="name" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="originalPrice" class="col-md-2 form-control-label"><span style="font-size: 20px">原价</span></label>
                                <div class="col-md-9">
                                    <input id="originalPrice" type="text" name="originalPrice" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="presentPrice" class="col-md-2 form-control-label"><span style="font-size: 20px">现价</span></label>
                                <div class="col-md-9">
                                    <input id="presentPrice" type="text" name="presentPrice" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="type" class="col-md-2 form-control-label"><span style="font-size: 20px">类型</span></label>
                                <div class="col-md-9">
                                    <input id="type" type="text" name="type" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="introduction" class="col-md-2 form-control-label"><span style="font-size: 20px">介绍</span></label>
                                <div class="col-md-9">
                                    <input id="introduction" type="text" name="introduction" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="stock" class="col-md-2 form-control-label"><span style="font-size: 20px">库存</span></label>
                                <div class="col-md-9">
                                    <input id="stock" type="text" name="stock" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="sold" class="col-md-2 form-control-label"><span style="font-size: 20px">已售</span></label>
                                <div class="col-md-9">
                                    <input id="sold" type="text" name="sold" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="supplierName" class="col-md-2 form-control-label"><span style="font-size: 20px">供应商</span></label>
                                <div class="col-md-9">
                                    <input id="supplierName" type="text" name="supplierName" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="pic" class="col-md-2 form-control-label"><span style="font-size: 20px">商品图片</span></label>
                                <div class="col-md-9">
                                    <img id="old_pic" src="">
                                    <input id="pic" type="file" name="pic" class="form-control" value="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-9 ml-auto">
                                    <button type="reset" class="btn btn-secondary">取消</button>
                                    <button type="button" class="btn btn-primary" onclick="userEdit()">修改</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../../vendor/jquery/jquery.min.js"></script>
<script src="../../vendor/popper.js/umd/popper.min.js"> </script>
<script src="../../vendor/bootstrap/js/bootstrap.min.js"></script>
<script src="../../vendor/jquery.cookie/jquery.cookie.js"> </script>
<script src="../../vendor/chart.js/Chart.min.js"></script>
<script src="../../js/js.cookie.min.js"></script>
<script src="../../js/charts-home.js"></script>
<script src="../../js/front.js"></script>
<script type="text/javascript">

    // 获取参数id的值
    function getQueryVariable(variable)
    {
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if(pair[0] == variable)
                return pair[1];
       }
       return false;
    }

    // 获取id用户的数据
    id = getQueryVariable('id');
    $.ajax({
        'type': 'get',
        'url': 'http://qiudaniu.top:5002/bazinga/api/good/getGoodById?goodId=' +　id,
        'headers' : {
                'admin_token': localStorage.getItem('admin-token'),
            },
        success: function(data){
            if (data.code == 200) {
                $("#name").val(data.data.name);
                $("#introduction").val(data.data.introduction);
                $("#originalPrice").val(data.data.originalPrice);
                $("#presentPrice").val(data.data.presentPrice);
                $("#sold").val(data.data.sold);
                $("#stock").val(data.data.stock);
                $("#type").val(data.data.goodType.typeName);
                $("#supplierName").val(data.data.supplier.supplierName);
                $("#old_pic").val(data.data.pic);
            }else{
                alert(data.message);
            }
        }
    })
    function userEdit(){
        var formData = new FormData();
        formData.append("name", $("#name").val());
        formData.append("introduction", $("#introduction").val());
        formData.append("orginalPrice", $("#orginalPrice").val());
        formData.append("goodImage",  document.getElementById("pic").files[0]);
        formData.append("presentPrice", $("#presentPrice").val());
        formData.append("sold", $("#sold").val());
        formData.append("stock", $("#stock").val());
        formData.append("type", $("#type").val());
        $.ajax({
            'type' : 'post',
            'url' : 'http://qiudaniu.top:5002/bazinga/api/user/updateUser',
            contentType: 'application/json',
            'headers' : {
                'admin_token': localStorage.getItem('admin-token'),
            },
            'data' : formData,
            'dataType' : 'json',
            success: function(data){
                if (data.code == 200) {
                    window.location.href = 'index.html';
                }else{
                    alert(data.message);
                }
            }
        })
    }
    function exit(){
        localStorage.removeItem('admin-token');
        if (! localStorage.getItem('admin-token')) {
            window.location.href = '../login.html';
        }
    }
</script>
</body>
</html>
